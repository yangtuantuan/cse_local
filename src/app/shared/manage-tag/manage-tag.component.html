<div class="modal-component">
  <h2>标签管理</h2>
  <div class="content">
    <d-data-table
      #datatable
      [dataSource]="dataSource"
      [scrollable]="true"
      [headerBg]="true"
      [type]="'striped'"
    >
      <thead dTableHead>
        <tr dTableRow>
          <th dHeadCell *ngFor="let column of columns">
            {{ column.header }}
          </th>
        </tr>
      </thead>
      <tbody dTableBody>
        <ng-template let-rowItem="rowItem" let-rowIndex="rowIndex">
          <tr
            dTableRow
            *ngIf="
              rowIndex === eidteIndex &&
              (headerNewForm || pager.pageIndex === 1)
            "
          >
            <td dTableCell [attr.colspan]="columns.length">
              <div
                *ngIf="!headerNewForm && pager.pageIndex === 1"
                (click)="newRow()"
                class="cursor-pointer"
              >
                <span class="tips-icon icon-add"></span>
                <span>新建</span>
              </div>
              <div *ngIf="headerNewForm" class="edit-padding-fix">
                <div class="input-block">
                  <input
                    class="devui-form-control"
                    [(ngModel)]="defaultRowData.key"
                    [placeholder]="'请输入key'"
                    type="text"
                  />
                </div>
                <div class="input-block">
                  <input
                    class="devui-form-control"
                    [(ngModel)]="defaultRowData.value"
                    [placeholder]="'请输入value'"
                    type="text"
                  />
                </div>
                <d-button style="margin-right: 5px" (click)="quickRowAdded()"
                  >确定</d-button
                >
                <d-button bsStyle="common" (click)="quickRowCancel()"
                  >取消</d-button
                >
              </div>
            </td>
          </tr>
          <tr dTableRow>
            <td dTableCell>{{ rowItem.key }}</td>
            <td dTableCell>{{ rowItem.value }}</td>
            <td dTableCell>
              <app-action-menu
                [maxShowNum]="3"
                [actions]="actionsFn(rowItem)"
                (menuClick)="menuClick($event, rowItem, rowIndex)"
              ></app-action-menu>
            </td>
          </tr>
        </ng-template>
        <ng-template #noResultTemplateRef>
          <tr dTableRow>
            <td dTableCell [attr.colspan]="columns.length">
              <div
                (click)="newRow()"
                class="cursor-pointer"
                style="padding: 10px 5px"
                *ngIf="!headerNewForm"
              >
                <span class="tips-icon icon-add"></span>
                <span>新建</span>
              </div>
              <div
                *ngIf="headerNewForm"
                class="edit-padding-fix"
                style="padding: 10px 5px"
              >
                <div class="input-block">
                  <input
                    class="devui-form-control"
                    [(ngModel)]="defaultRowData.key"
                    [placeholder]="'请输入key'"
                    type="text"
                  />
                </div>
                <div class="input-block">
                  <input
                    class="devui-form-control"
                    [(ngModel)]="defaultRowData.value"
                    [placeholder]="'请输入value'"
                    type="text"
                  />
                </div>
                <d-button style="margin-right: 5px" (click)="quickRowAdded()"
                  >确定</d-button
                >
                <d-button bsStyle="common" (click)="quickRowCancel()"
                  >取消</d-button
                >
              </div>
            </td>
          </tr>
        </ng-template>
      </tbody>
    </d-data-table>
    <d-pagination
      class="cse-mg-top-xs"
      *ngIf="pager.total > pager.pageSizeOptions[0]"
      [size]="'sm'"
      [total]="pager.total"
      [(pageSize)]="pager.pageSize"
      [(pageIndex)]="pager.pageIndex"
      [canViewTotal]="true"
      [canChangePageSize]="true"
      [pageSizeOptions]="pager.pageSizeOptions"
      [maxItems]="5"
      (pageIndexChange)="onPaginationChange($event, pager.pageSize)"
      (pageSizeChange)="onPaginationChange(pager.pageIndex, $event)"
    >
    </d-pagination>
  </div>
  <div class="footer">
    <d-button bsStyle="danger" (click)="onConfirmBtn()">确定</d-button>
    <d-button bsStyle="common" (click)="onCancel()" class="cse-mg-left-lg">
      取消
    </d-button>
  </div>
</div>
